<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Sungwoo stamping pvt Ltd</title>
<link href="https://fonts.googleapis.com/css2?family=Bebas+Neue&family=DM+Mono:wght@400;500&family=DM+Sans:wght@300;400;500;600&display=swap" rel="stylesheet">
<style>
/* ===================== GLOBAL ===================== */
:root {
  --bg: #f0f4f8;
  --surface: #ffffff;
  --surface2: #e8eef5;
  --border: #d0dbe8;
  --accent: #0066cc;
  --accent2: #e84c1e;
  --accent3: #0099aa;
  --warn: #d97706;
  --text: #1a2637;
  --muted: #6b7e96;
  --danger: #dc2626;
}
* { margin:0; padding:0; box-sizing:border-box; }
body {
  background: var(--bg);
  color: var(--text);
  font-family: 'DM Sans', sans-serif;
  min-height: 100vh;
  overflow-x: hidden;
}
body::before {
  content:'';
  position:fixed; inset:0;
  background-image:
    linear-gradient(var(--border) 1px, transparent 1px),
    linear-gradient(90deg, var(--border) 1px, transparent 1px);
  background-size: 40px 40px;
  opacity: 0.5;
  pointer-events:none; z-index:0;
}

/* ===================== PAGES ===================== */
.page { display:none; min-height:100vh; position:relative; z-index:1; }
.page.active { display:flex; flex-direction:column; }

/* ===================== LOGIN PAGE ===================== */
#loginPage {
  align-items: center;
  justify-content: center;
  padding: 20px;
}
.login-card {
  background: var(--surface);
  border: 1px solid var(--border);
  border-radius: 20px;
  width: 100%;
  max-width: 420px;
  overflow: hidden;
  box-shadow: 0 20px 60px rgba(0,0,0,0.12), 0 0 0 1px rgba(0,102,204,0.08);
  animation: slideUp 0.5s ease;
}
@keyframes slideUp {
  from { opacity:0; transform:translateY(30px); }
  to   { opacity:1; transform:translateY(0); }
}
.login-header {
  background: linear-gradient(135deg, #1a4a8a 0%, #0d2d5c 100%);
  padding: 40px 36px 30px;
  text-align: center;
  border-bottom: 1px solid var(--border);
  position: relative;
  overflow: hidden;
}
.login-header::before {
  content:'';
  position:absolute; top:-40px; right:-40px;
  width:130px; height:130px;
  border-radius:50%;
  background: radial-gradient(circle, rgba(0,229,160,0.15), transparent 70%);
}
.login-logo-icon {
  width: 64px; height: 64px;
  background: var(--accent);
  border-radius: 16px;
  display: inline-flex;
  align-items: center;
  justify-content: center;
  font-family: 'Bebas Neue', sans-serif;
  font-size: 1.4rem;
  color: #0a1628;
  letter-spacing: 2px;
  margin-bottom: 16px;
  box-shadow: 0 0 30px rgba(0,102,204,0.35);
}
.login-company {
  font-family: 'Bebas Neue', sans-serif;
  font-size: 1.8rem;
  letter-spacing: 4px;
  color: var(--text);
}
.login-company span { color: var(--accent); }
.login-sub {
  font-family: 'DM Mono', monospace;
  font-size: 0.62rem;
  color: var(--muted);
  letter-spacing: 2px;
  text-transform: uppercase;
  margin-top: 5px;
}
.login-body { padding: 32px 36px; }
.login-title {
  font-family: 'Bebas Neue', sans-serif;
  font-size: 1.2rem;
  letter-spacing: 3px;
  color: var(--text);
  margin-bottom: 22px;
  text-align: center;
}
.form-group { margin-bottom: 14px; }
label {
  display: block;
  font-size: 0.67rem;
  text-transform: uppercase;
  letter-spacing: 1.5px;
  color: var(--muted);
  margin-bottom: 6px;
  font-family: 'DM Mono', monospace;
}
input, select {
  width: 100%;
  background: var(--surface2);
  border: 1px solid var(--border);
  border-radius: 8px;
  padding: 11px 14px;
  color: var(--text);
  font-family: 'DM Mono', monospace;
  font-size: 0.84rem;
  transition: border-color 0.2s, box-shadow 0.2s;
  outline: none;
}
input:focus, select:focus {
  border-color: var(--accent);
  box-shadow: 0 0 0 3px rgba(0,229,160,0.1);
}
select option { background: var(--surface2); }
.role-tabs {
  display: grid;
  grid-template-columns: 1fr 1fr;
  gap: 8px;
  margin-bottom: 18px;
}
.role-tab {
  padding: 10px;
  border: 1px solid var(--border);
  border-radius: 8px;
  background: var(--surface2);
  color: var(--muted);
  font-family: 'DM Mono', monospace;
  font-size: 0.78rem;
  cursor: pointer;
  text-align: center;
  transition: all 0.2s;
  letter-spacing: 1px;
}
.role-tab.active {
  border-color: var(--accent);
  color: var(--accent);
  background: rgba(0,229,160,0.08);
}
.btn {
  width: 100%;
  padding: 12px;
  border: none;
  border-radius: 8px;
  font-family: 'Bebas Neue', sans-serif;
  font-size: 1.1rem;
  letter-spacing: 2px;
  cursor: pointer;
  transition: all 0.2s;
}
.btn-primary { background: var(--accent); color: #fff; }
.btn-primary:hover { background:#0052a3; transform:translateY(-1px); box-shadow:0 8px 20px rgba(0,102,204,0.3); }
.btn-sm { width:auto; padding:8px 16px; font-size:0.78rem; border-radius:6px; letter-spacing:1px; }
.login-error {
  background: rgba(255,68,68,0.1);
  border: 1px solid rgba(255,68,68,0.3);
  border-radius: 8px;
  padding: 10px 14px;
  font-family: 'DM Mono', monospace;
  font-size: 0.76rem;
  color: var(--danger);
  margin-top: 12px;
  display: none;
}
.login-hint {
  text-align: center;
  font-family: 'DM Mono', monospace;
  font-size: 0.63rem;
  color: var(--muted);
  margin-top: 20px;
  line-height: 1.9;
}

/* ===================== HEADER ===================== */
header {
  border-bottom: 1px solid var(--border);
  padding: 14px 0;
  position: sticky;
  top: 0;
  background: rgba(240,244,248,0.97);
  backdrop-filter: blur(12px);
  z-index: 100;
}
.header-inner {
  display: flex;
  align-items: center;
  justify-content: space-between;
  position: relative;
  max-width: 1400px;
  margin: 0 auto;
  padding: 0 24px;
}
.company-logo { display:flex; align-items:center; gap:12px; }
.company-logo-icon { flex-shrink:0; filter:drop-shadow(0 2px 8px rgba(0,102,204,0.3)); }
.company-name { font-family:'Bebas Neue',sans-serif; font-size:1.4rem; letter-spacing:3px; color:var(--text); line-height:1; }
.company-name span { color:var(--accent); }
.company-tagline { font-family:'DM Mono',monospace; font-size:0.57rem; color:var(--muted); letter-spacing:1.5px; text-transform:uppercase; margin-top:3px; }
.nav-links { display:flex; align-items:center; gap:6px; }
.nav-btn {
  padding: 7px 16px;
  border-radius: 7px;
  font-family: 'DM Mono', monospace;
  font-size: 0.72rem;
  letter-spacing: 1px;
  cursor: pointer;
  transition: all 0.2s;
  border: 1px solid var(--border);
  background: transparent;
  color: var(--muted);
  text-transform: uppercase;
}
.nav-btn:hover { border-color:var(--accent3); color:var(--accent3); }
.nav-btn.active { background:rgba(0,229,160,0.1); border-color:var(--accent); color:var(--accent); }
.nav-btn.logout { border-color:rgba(255,68,68,0.3); color:var(--danger); }
.nav-btn.logout:hover { background:rgba(255,68,68,0.1); }
.header-right { display:flex; align-items:center; gap:12px; }
.user-pill {
  display:flex; align-items:center; gap:8px;
  background:var(--surface2); border:1px solid var(--border);
  border-radius:20px; padding:5px 14px 5px 6px;
  font-family:'DM Mono',monospace; font-size:0.72rem; color:var(--text);
}
.user-avatar {
  width:26px; height:26px; border-radius:50%;
  background:var(--accent); color:#000;
  display:flex; align-items:center; justify-content:center;
  font-weight:700; font-size:0.72rem;
}
.status-dot { display:inline-block; width:7px; height:7px; border-radius:50%; background:var(--accent); animation:pulse 2s infinite; margin-right:4px; }
@keyframes pulse { 0%,100%{opacity:1} 50%{opacity:0.3} }
.header-clock { font-family:'DM Mono',monospace; font-size:0.62rem; color:var(--muted); text-align:right; }

/* ===================== LAYOUT ===================== */
.container { max-width:1400px; margin:0 auto; padding:0 24px; position:relative; z-index:1; }
main { padding:34px 0; }

/* ===================== STAT CARDS ===================== */
.summary-grid { display:grid; grid-template-columns:repeat(4,1fr); gap:16px; margin-bottom:34px; }
.stat-card { background:var(--surface); border:1px solid var(--border); border-radius:12px; padding:22px; position:relative; overflow:hidden; transition:border-color 0.3s; }
.stat-card::before { content:''; position:absolute; top:0;left:0;right:0; height:2px; }
.stat-card.green::before{background:var(--accent);}
.stat-card.orange::before{background:var(--accent2);}
.stat-card.blue::before{background:var(--accent3);}
.stat-card.yellow::before{background:var(--warn);}
.stat-card:hover{border-color:var(--accent);}
.stat-label{font-size:0.67rem;text-transform:uppercase;letter-spacing:2px;color:var(--muted);margin-bottom:6px;font-family:'DM Mono',monospace;}
.stat-value{font-family:'Bebas Neue',sans-serif;font-size:2.5rem;line-height:1;letter-spacing:2px;}
.stat-card.green .stat-value{color:var(--accent);}
.stat-card.orange .stat-value{color:var(--accent2);}
.stat-card.blue .stat-value{color:var(--accent3);}
.stat-card.yellow .stat-value{color:var(--warn);}

/* ===================== PANELS ===================== */
.two-col{display:grid;grid-template-columns:420px 1fr;gap:24px;margin-bottom:34px;}
.panel{background:var(--surface);border:1px solid var(--border);border-radius:16px;overflow:hidden;}
.panel-header{padding:18px 24px;border-bottom:1px solid var(--border);display:flex;align-items:center;gap:12px;}
.panel-title{font-family:'Bebas Neue',sans-serif;font-size:1.15rem;letter-spacing:2px;color:var(--text);}
.panel-icon{width:30px;height:30px;border-radius:8px;display:flex;align-items:center;justify-content:center;font-size:0.95rem;}
.panel-icon.green{background:rgba(0,229,160,0.1);}
.panel-icon.blue{background:rgba(91,184,255,0.1);}
.panel-icon.orange{background:rgba(255,107,53,0.1);}
.panel-icon.purple{background:rgba(180,100,255,0.1);}
.panel-body{padding:22px;}
.form-row{display:grid;grid-template-columns:1fr 1fr;gap:12px;margin-bottom:12px;}
.qty-row{display:grid;grid-template-columns:1fr 1fr 1fr;gap:12px;margin-bottom:14px;}

/* ===================== TABLE ===================== */
.table-wrap{overflow-x:auto;}
table{width:100%;border-collapse:collapse;}
thead th{font-family:'DM Mono',monospace;font-size:0.62rem;text-transform:uppercase;letter-spacing:2px;color:var(--muted);padding:10px 16px;text-align:left;border-bottom:1px solid var(--border);white-space:nowrap;}
tbody tr{border-bottom:1px solid rgba(30,58,110,0.4);transition:background 0.15s;animation:fadeIn 0.4s ease;}
@keyframes fadeIn{from{opacity:0;transform:translateY(6px)}to{opacity:1;transform:translateY(0)}}
tbody tr:hover{background:var(--surface2);}
tbody td{padding:13px 16px;font-size:0.84rem;vertical-align:middle;}
.mono{font-family:'DM Mono',monospace;font-size:0.79rem;}
.progress-bar{width:110px;height:6px;background:var(--border);border-radius:3px;overflow:hidden;}
.progress-fill{height:100%;border-radius:3px;transition:width 0.8s ease;}
.badge{display:inline-flex;align-items:center;gap:5px;padding:3px 10px;border-radius:20px;font-size:0.67rem;font-family:'DM Mono',monospace;}
.badge-complete{background:rgba(0,102,204,0.1);color:#0066cc;border:1px solid rgba(0,102,204,0.3);}
.badge-progress{background:rgba(0,153,170,0.1);color:#007a88;border:1px solid rgba(0,153,170,0.3);}
.badge-pending{background:rgba(232,76,30,0.1);color:#c43a10;border:1px solid rgba(232,76,30,0.3);}
.action-btn{background:none;border:1px solid var(--border);border-radius:6px;padding:4px 10px;color:var(--muted);cursor:pointer;font-size:0.72rem;font-family:'DM Mono',monospace;transition:all 0.2s;}
.action-btn:hover{border-color:var(--danger);color:var(--danger);}
.empty-state{text-align:center;padding:48px 20px;color:var(--muted);font-family:'DM Mono',monospace;font-size:0.8rem;}
.empty-state .icon{font-size:2.4rem;margin-bottom:12px;opacity:0.3;}
.section-title{font-family:'Bebas Neue',sans-serif;font-size:1.4rem;letter-spacing:3px;margin-bottom:18px;display:flex;align-items:center;gap:12px;}
.section-title::after{content:'';flex:1;height:1px;background:var(--border);}
canvas{max-height:300px;}

/* ===================== ADMIN ===================== */
.admin-grid{display:grid;grid-template-columns:repeat(3,1fr);gap:22px;margin-bottom:34px;}
.admin-card{background:var(--surface);border:1px solid var(--border);border-radius:16px;overflow:hidden;}
.admin-card-header{padding:16px 22px;border-bottom:1px solid var(--border);display:flex;align-items:center;justify-content:space-between;}
.admin-card-title{font-family:'Bebas Neue',sans-serif;font-size:1.1rem;letter-spacing:2px;display:flex;align-items:center;gap:8px;}
.admin-card-body{padding:20px 22px;}
.admin-input-row{display:flex;gap:8px;margin-bottom:14px;}
.admin-input-row input{flex:1;}
.admin-add-btn{background:var(--accent);color:#fff;border:none;border-radius:8px;padding:0 16px;font-family:'Bebas Neue',sans-serif;font-size:1rem;letter-spacing:1px;cursor:pointer;white-space:nowrap;transition:all 0.2s;}
.admin-add-btn:hover{background:#0052a3;}
.admin-list{list-style:none;max-height:260px;overflow-y:auto;}
.admin-list::-webkit-scrollbar{width:4px;}
.admin-list::-webkit-scrollbar-track{background:var(--surface2);}
.admin-list::-webkit-scrollbar-thumb{background:var(--border);border-radius:2px;}
.admin-list li{display:flex;align-items:center;justify-content:space-between;padding:9px 12px;border-radius:8px;margin-bottom:4px;background:var(--surface2);font-family:'DM Mono',monospace;font-size:0.8rem;color:var(--text);animation:fadeIn 0.3s ease;}
.admin-list li:hover{background:#1a3362;}
.admin-delete-btn{background:none;border:none;color:var(--muted);cursor:pointer;font-size:0.9rem;padding:2px 6px;border-radius:4px;transition:all 0.2s;line-height:1;}
.admin-delete-btn:hover{color:var(--danger);background:rgba(255,68,68,0.1);}
.admin-empty{font-family:'DM Mono',monospace;font-size:0.75rem;color:var(--muted);text-align:center;padding:22px;}
.count-badge{font-family:'DM Mono',monospace;font-size:0.63rem;background:var(--surface2);border:1px solid var(--border);border-radius:10px;padding:2px 9px;color:var(--muted);}

/* ===================== TOAST ===================== */
.toast{position:fixed;bottom:24px;right:24px;background:var(--accent);color:#fff;padding:11px 20px;border-radius:10px;font-family:'DM Mono',monospace;font-size:0.8rem;font-weight:500;z-index:999;opacity:0;transform:translateY(20px);transition:all 0.3s;}
.toast.show{opacity:1;transform:translateY(0);}
.toast.error{background:var(--danger);color:#fff;}

/* ===================== RESPONSIVE ===================== */
@media(max-width:1100px){.two-col{grid-template-columns:1fr;}.summary-grid{grid-template-columns:repeat(2,1fr);}.admin-grid{grid-template-columns:1fr;}}
@media(max-width:600px){.summary-grid{grid-template-columns:1fr 1fr;}.form-row{grid-template-columns:1fr;}.qty-row{grid-template-columns:1fr;}}
</style>
</head>
<body>

<!-- ==================== LOGIN PAGE ==================== -->
<div id="loginPage" class="page active">
  <div class="login-card">
    <div class="login-header">
      <div class="login-logo-icon">ABC</div>
      <div class="login-company">ABC <span>Company</span></div>
      <div class="login-sub">Manufacturing &amp; Production Division</div>
    </div>
    <div class="login-body">
      <div class="login-title">SIGN IN TO PRODTRACK</div>
      <div style="margin-bottom:16px;">
        <label>Login As</label>
        <div class="role-tabs">
          <div class="role-tab active" onclick="selectRole('admin')" id="roleAdmin">üîê Admin</div>
          <div class="role-tab" onclick="selectRole('operator')" id="roleOperator">üë∑ Operator</div>
        </div>
      </div>
      <div class="form-group">
        <label>Username</label>
        <input type="text" id="loginUser" placeholder="Enter username" autocomplete="off">
      </div>
      <div class="form-group">
        <label>Password</label>
        <input type="password" id="loginPass" placeholder="Enter password" onkeydown="if(event.key==='Enter')doLogin()">
      </div>
      <button class="btn btn-primary" onclick="doLogin()" style="margin-top:6px;">SIGN IN</button>
      <div class="login-error" id="loginError">Invalid username or password.</div>
      <div class="login-hint">
        Admin: &nbsp;<b>admin</b> / <b>admin123</b><br>
        Operator: <b>operator</b> / <b>op123</b>
      </div>
    </div>
  </div>
</div>

<!-- ==================== MAIN APP ==================== -->
<div id="appPage" class="page">

  <header>
    <div class="header-inner">
      <!-- Logo -->
      <div class="company-logo">
        <div class="company-logo-icon">
          <svg width="38" height="38" viewBox="0 0 38 38" fill="none">
            <rect width="38" height="38" rx="9" fill="#0066cc"/>
            <text x="50%" y="54%" dominant-baseline="middle" text-anchor="middle"
              font-family="Bebas Neue, sans-serif" font-size="13" fill="#ffffff" font-weight="700">ABC</text>
          </svg>
        </div>
        <div>
          <div class="company-name">ABC <span>Company</span></div>
          <div class="company-tagline">Manufacturing &amp; Production Division</div>
        </div>
      </div>

      <!-- Nav -->
      <div class="nav-links">
        <button class="nav-btn active" id="navDashboard" onclick="showSection('dashboard')">üìä Dashboard</button>
        <button class="nav-btn" id="navAdmin" onclick="showSection('admin')" style="display:none;">‚öôÔ∏è Admin Panel</button>
      </div>

      <!-- Right -->
      <div class="header-right">
        <div class="header-clock"><span class="status-dot"></span>LIVE &nbsp;|&nbsp; <span id="clockDisplay"></span></div>
        <div class="user-pill">
          <div class="user-avatar" id="userAvatar">A</div>
          <span id="userLabel">Admin</span>
        </div>
        <button class="nav-btn logout" onclick="doLogout()">‚èª Logout</button>
      </div>
    </div>
  </header>

  <!-- DASHBOARD -->
  <div id="sectionDashboard">
    <main>
      <div class="container">
        <div class="summary-grid">
          <div class="stat-card green"><div class="stat-label">Total Orders</div><div class="stat-value" id="totalOrders">0</div></div>
          <div class="stat-card blue"><div class="stat-label">Total Quantity</div><div class="stat-value" id="totalQty">0</div></div>
          <div class="stat-card yellow"><div class="stat-label">Completed</div><div class="stat-value" id="totalCompleted">0</div></div>
          <div class="stat-card orange"><div class="stat-label">Pending</div><div class="stat-value" id="totalPending">0</div></div>
        </div>

        <div class="two-col">
          <div class="panel">
            <div class="panel-header">
              <div class="panel-icon green">‚ûï</div>
              <div class="panel-title">ADD PRODUCTION ENTRY</div>
            </div>
            <div class="panel-body">
              <div class="form-row">
                <div class="form-group" style="margin-bottom:0">
                  <label>Feed / Line</label>
                  <input type="text" id="feed" placeholder="e.g. LINE-A1">
                </div>
                <div class="form-group" style="margin-bottom:0">
                  <label>Model</label>
                  <select id="model"><option value="">‚Äî Select Model ‚Äî</option></select>
                </div>
              </div>
              <div class="form-row">
                <div class="form-group" style="margin-bottom:0">
                  <label>Serial No.</label>
                  <select id="serial"><option value="">‚Äî Select Serial ‚Äî</option></select>
                </div>
                <div class="form-group" style="margin-bottom:0">
                  <label>Assembly Name</label>
                  <select id="assembly"><option value="">‚Äî Select Assembly ‚Äî</option></select>
                </div>
              </div>
              <div class="qty-row" style="margin-top:12px;">
                <div class="form-group">
                  <label>Total Qty</label>
                  <input type="number" id="totalQtyInput" min="1" placeholder="500" oninput="autoCalcPending()">
                </div>
                <div class="form-group">
                  <label>Completed</label>
                  <input type="number" id="completedInput" min="0" placeholder="0" oninput="autoCalcPending()">
                </div>
                <div class="form-group">
                  <label>Pending</label>
                  <input type="number" id="pendingInput" min="0" placeholder="0" readonly style="opacity:0.6">
                </div>
              </div>
              <div class="form-row">
                <div class="form-group" style="margin-bottom:0">
                  <label>Status</label>
                  <select id="status">
                    <option>In Progress</option>
                    <option>Completed</option>
                    <option>Pending</option>
                  </select>
                </div>
                <div class="form-group" style="margin-bottom:0">
                  <label>Priority</label>
                  <select id="priority">
                    <option>Normal</option>
                    <option>High</option>
                    <option>Critical</option>
                  </select>
                </div>
              </div>
              <button class="btn btn-primary" onclick="addEntry()" style="margin-top:16px;">ADD TO PRODUCTION LOG</button>
            </div>
          </div>

          <div class="panel">
            <div class="panel-header">
              <div class="panel-icon blue">üìà</div>
              <div class="panel-title">PRODUCTION OVERVIEW</div>
            </div>
            <div style="padding:22px;">
              <div style="display:grid;grid-template-columns:1fr 1fr;gap:20px;align-items:center;">
                <div>
                  <div style="font-size:0.67rem;color:var(--muted);font-family:'DM Mono',monospace;letter-spacing:1px;margin-bottom:10px;text-transform:uppercase;">Completion Ratio</div>
                  <canvas id="donutChart" width="200" height="200"></canvas>
                </div>
                <div>
                  <div style="font-size:0.67rem;color:var(--muted);font-family:'DM Mono',monospace;letter-spacing:1px;margin-bottom:10px;text-transform:uppercase;">By Assembly</div>
                  <canvas id="barChart" width="300" height="200"></canvas>
                </div>
              </div>
            </div>
          </div>
        </div>

        <div class="section-title">PRODUCTION LOG</div>
        <div class="panel">
          <div class="table-wrap">
            <table>
              <thead>
                <tr>
                  <th>#</th><th>Feed/Line</th><th>Model</th><th>Serial No.</th>
                  <th>Assembly</th><th>Total Qty</th><th>Completed</th><th>Pending</th>
                  <th>Progress</th><th>Status</th><th>Priority</th><th>Added By</th><th>Action</th>
                </tr>
              </thead>
              <tbody id="tableBody">
                <tr><td colspan="13"><div class="empty-state"><div class="icon">üè≠</div><div>No entries yet. Add one above.</div></div></td></tr>
              </tbody>
            </table>
          </div>
        </div>
      </div>
    </main>
  </div>

  <!-- ADMIN PANEL -->
  <div id="sectionAdmin" style="display:none;">
    <main>
      <div class="container">

        <div class="section-title">ADMIN PANEL ‚Äî MASTER DATA</div>

        <div class="admin-grid">
          <!-- Models -->
          <div class="admin-card">
            <div class="admin-card-header">
              <div class="admin-card-title"><span>üîß</span> Models</div>
              <span class="count-badge" id="modelCount">0 items</span>
            </div>
            <div class="admin-card-body">
              <div class="admin-input-row">
                <input type="text" id="newModel" placeholder="e.g. MX-500" onkeydown="if(event.key==='Enter')addMaster('models','newModel','modelList','modelCount')">
                <button class="admin-add-btn" onclick="addMaster('models','newModel','modelList','modelCount')">+ ADD</button>
              </div>
              <ul class="admin-list" id="modelList"></ul>
            </div>
          </div>

          <!-- Serials -->
          <div class="admin-card">
            <div class="admin-card-header">
              <div class="admin-card-title"><span>üî¢</span> Serial Numbers</div>
              <span class="count-badge" id="serialCount">0 items</span>
            </div>
            <div class="admin-card-body">
              <div class="admin-input-row">
                <input type="text" id="newSerial" placeholder="e.g. SN-20240001" onkeydown="if(event.key==='Enter')addMaster('serials','newSerial','serialList','serialCount')">
                <button class="admin-add-btn" onclick="addMaster('serials','newSerial','serialList','serialCount')">+ ADD</button>
              </div>
              <ul class="admin-list" id="serialList"></ul>
            </div>
          </div>

          <!-- Assemblies -->
          <div class="admin-card">
            <div class="admin-card-header">
              <div class="admin-card-title"><span>üèóÔ∏è</span> Assembly Names</div>
              <span class="count-badge" id="assemblyCount">0 items</span>
            </div>
            <div class="admin-card-body">
              <div class="admin-input-row">
                <input type="text" id="newAssembly" placeholder="e.g. Engine Block" onkeydown="if(event.key==='Enter')addMaster('assemblies','newAssembly','assemblyList','assemblyCount')">
                <button class="admin-add-btn" onclick="addMaster('assemblies','newAssembly','assemblyList','assemblyCount')">+ ADD</button>
              </div>
              <ul class="admin-list" id="assemblyList"></ul>
            </div>
          </div>
        </div>

        <!-- User Management -->
        <div class="section-title">USER MANAGEMENT</div>
        <div class="panel">
          <div class="panel-header">
            <div class="panel-icon purple">üë•</div>
            <div class="panel-title">SYSTEM USERS</div>
          </div>
          <div class="panel-body">
            <div style="display:grid;grid-template-columns:1fr 1fr 1fr 160px;gap:12px;margin-bottom:20px;">
              <div class="form-group" style="margin-bottom:0">
                <label>Username</label>
                <input type="text" id="newUserName" placeholder="e.g. john_doe">
              </div>
              <div class="form-group" style="margin-bottom:0">
                <label>Password</label>
                <input type="password" id="newUserPass" placeholder="Password">
              </div>
              <div class="form-group" style="margin-bottom:0">
                <label>Role</label>
                <select id="newUserRole">
                  <option value="admin">Admin</option>
                  <option value="operator">Operator</option>
                </select>
              </div>
              <div class="form-group" style="margin-bottom:0;display:flex;align-items:flex-end;">
                <button class="btn btn-primary" style="padding:11px;font-size:0.88rem;" onclick="addUser()">ADD USER</button>
              </div>
            </div>
            <div class="table-wrap">
              <table>
                <thead>
                  <tr><th>#</th><th>Username</th><th>Role</th><th>Added</th><th>Action</th></tr>
                </thead>
                <tbody id="userTableBody"></tbody>
              </table>
            </div>
          </div>
        </div>

      </div>
    </main>
  </div>

</div><!-- end appPage -->

<div class="toast" id="toast"></div>

<script>
/* ==================== DATABASE ==================== */
const DEFAULT_USERS = [
  { id:1, username:'admin',    password:'admin123', role:'admin',    added:'System' },
  { id:2, username:'operator', password:'op123',    role:'operator', added:'System' }
];

let db = {
  users:      JSON.parse(localStorage.getItem('pt_users'))      || DEFAULT_USERS,
  entries:    JSON.parse(localStorage.getItem('pt_entries'))    || [],
  models:     JSON.parse(localStorage.getItem('pt_models'))     || ['MX-500','TX-200','LX-900'],
  serials:    JSON.parse(localStorage.getItem('pt_serials'))    || ['SN-20240001','SN-20240002','SN-20240003'],
  assemblies: JSON.parse(localStorage.getItem('pt_assemblies')) || ['Engine Block','Gearbox','Frame','Exhaust'],
};

let currentUser = null;
let selectedRole = 'admin';

function save(key) { localStorage.setItem('pt_'+key, JSON.stringify(db[key])); }

/* ==================== LOGIN ==================== */
function selectRole(role) {
  selectedRole = role;
  document.getElementById('roleAdmin').classList.toggle('active', role==='admin');
  document.getElementById('roleOperator').classList.toggle('active', role==='operator');
}

function doLogin() {
  const u = document.getElementById('loginUser').value.trim();
  const p = document.getElementById('loginPass').value;
  const err = document.getElementById('loginError');
  const user = db.users.find(x => x.username===u && x.password===p && x.role===selectedRole);
  if (!user) { err.style.display='block'; return; }
  err.style.display='none';
  currentUser = user;
  document.getElementById('userLabel').textContent = user.username;
  document.getElementById('userAvatar').textContent = user.username[0].toUpperCase();
  document.getElementById('navAdmin').style.display = user.role==='admin' ? '' : 'none';
  showPage('appPage');
  showSection('dashboard');
  render();
}

function doLogout() {
  currentUser = null;
  document.getElementById('loginUser').value='';
  document.getElementById('loginPass').value='';
  showPage('loginPage');
}

/* ==================== ROUTING ==================== */
function showPage(id) {
  document.querySelectorAll('.page').forEach(p=>p.classList.remove('active'));
  document.getElementById(id).classList.add('active');
}

function showSection(sec) {
  document.getElementById('sectionDashboard').style.display = sec==='dashboard' ? '' : 'none';
  document.getElementById('sectionAdmin').style.display      = sec==='admin'     ? '' : 'none';
  document.getElementById('navDashboard').classList.toggle('active', sec==='dashboard');
  document.getElementById('navAdmin').classList.toggle('active', sec==='admin');
  if(sec==='admin') renderAdmin();
}

/* ==================== DASHBOARD ==================== */
function autoCalcPending() {
  const t = parseInt(document.getElementById('totalQtyInput').value)||0;
  const c = parseInt(document.getElementById('completedInput').value)||0;
  document.getElementById('pendingInput').value = Math.max(0, t-c);
}

function addEntry() {
  const feed     = document.getElementById('feed').value.trim();
  const model    = document.getElementById('model').value;
  const serial   = document.getElementById('serial').value;
  const assembly = document.getElementById('assembly').value;
  const total    = parseInt(document.getElementById('totalQtyInput').value);
  const completed= parseInt(document.getElementById('completedInput').value)||0;
  const status   = document.getElementById('status').value;
  const priority = document.getElementById('priority').value;

  if (!feed||!model||!serial||!assembly||!total) {
    showToast('Please fill all required fields.','error'); return;
  }
  const pending = Math.max(0, total-completed);
  db.entries.push({
    id:Date.now(), feed, model, serial, assembly,
    total, completed, pending, status, priority,
    date:new Date().toLocaleDateString(),
    addedBy: currentUser ? currentUser.username : 'Unknown'
  });
  save('entries');
  render();
  showToast('Entry added successfully!');
  document.getElementById('feed').value='';
  document.getElementById('totalQtyInput').value='';
  document.getElementById('completedInput').value='';
  document.getElementById('pendingInput').value='';
  document.getElementById('model').value='';
  document.getElementById('serial').value='';
  document.getElementById('assembly').value='';
}

function deleteEntry(id) {
  if(!confirm('Delete this production entry?')) return;
  db.entries = db.entries.filter(e=>e.id!==id);
  save('entries');
  render();
  showToast('Entry deleted.');
}

function render() {
  renderDropdowns();
  renderTable();
  renderStats();
  renderCharts();
}

function renderDropdowns() {
  const fields = [['model','models'],['serial','serials'],['assembly','assemblies']];
  fields.forEach(([fid, key]) => {
    const sel = document.getElementById(fid);
    const cur = sel.value;
    sel.innerHTML = `<option value="">‚Äî Select ‚Äî</option>` +
      db[key].map(v=>`<option value="${v}"${v===cur?' selected':''}>${v}</option>`).join('');
  });
}

function renderStats() {
  document.getElementById('totalOrders').textContent    = db.entries.length;
  document.getElementById('totalQty').textContent       = db.entries.reduce((s,e)=>s+e.total,0);
  document.getElementById('totalCompleted').textContent = db.entries.reduce((s,e)=>s+e.completed,0);
  document.getElementById('totalPending').textContent   = db.entries.reduce((s,e)=>s+e.pending,0);
}

function renderTable() {
  const tbody = document.getElementById('tableBody');
  if (!db.entries.length) {
    tbody.innerHTML=`<tr><td colspan="13"><div class="empty-state"><div class="icon">üè≠</div><div>No production entries yet.<br>Add one using the form above.</div></div></td></tr>`;
    return;
  }
  tbody.innerHTML = db.entries.map((e,i)=>{
    const pct  = e.total>0 ? Math.round((e.completed/e.total)*100) : 0;
    const barC = pct===100?'var(--accent)':pct>50?'var(--accent3)':'var(--accent2)';
    const badge = e.status==='Completed'?`<span class="badge badge-complete">‚úì Completed</span>`
                : e.status==='In Progress'?`<span class="badge badge-progress">‚óâ In Progress</span>`
                : `<span class="badge badge-pending">‚è≥ Pending</span>`;
    const pc   = e.priority==='Critical'?'var(--danger)':e.priority==='High'?'var(--warn)':'var(--muted)';
    const canDel = currentUser && (currentUser.role==='admin' || e.addedBy===currentUser.username);
    return `<tr>
      <td class="mono" style="color:var(--muted)">${String(i+1).padStart(2,'0')}</td>
      <td><strong>${e.feed}</strong></td>
      <td class="mono">${e.model}</td>
      <td class="mono" style="color:var(--accent3)">${e.serial}</td>
      <td>${e.assembly}</td>
      <td class="mono" style="font-weight:600">${e.total}</td>
      <td class="mono" style="color:var(--accent)">${e.completed}</td>
      <td class="mono" style="color:var(--accent2)">${e.pending}</td>
      <td>
        <div style="display:flex;align-items:center;gap:8px">
          <div class="progress-bar"><div class="progress-fill" style="width:${pct}%;background:${barC}"></div></div>
          <span class="mono" style="font-size:0.67rem;color:var(--muted)">${pct}%</span>
        </div>
      </td>
      <td>${badge}</td>
      <td style="color:${pc};font-size:0.72rem;font-family:'DM Mono',monospace">${e.priority}</td>
      <td class="mono" style="color:var(--muted);font-size:0.72rem">${e.addedBy||'‚Äî'}</td>
      <td>${canDel?`<button class="action-btn" onclick="deleteEntry(${e.id})">‚úï DEL</button>`:'<span style="color:var(--muted);font-size:0.7rem">‚Äî</span>'}</td>
    </tr>`;
  }).join('');
}

/* ==================== CHARTS ==================== */
function renderCharts() { renderDonut(); renderBar(); }

function renderDonut() {
  const c=document.getElementById('donutChart'), ctx=c.getContext('2d');
  const completed=db.entries.reduce((s,e)=>s+e.completed,0);
  const pending=db.entries.reduce((s,e)=>s+e.pending,0);
  const total=completed+pending;
  ctx.clearRect(0,0,c.width,c.height);
  if(!total){
    ctx.fillStyle='#d0dbe8'; ctx.beginPath(); ctx.arc(100,100,70,0,Math.PI*2); ctx.fill();
    ctx.fillStyle='#ffffff'; ctx.beginPath(); ctx.arc(100,100,46,0,Math.PI*2); ctx.fill();
    ctx.fillStyle='#6b7e96'; ctx.font='11px DM Mono'; ctx.textAlign='center'; ctx.fillText('No data',100,104); return;
  }
  let start=-Math.PI/2;
  [{value:completed,color:'#0066cc'},{value:pending,color:'#e84c1e'}].forEach(seg=>{
    const sw=(seg.value/total)*Math.PI*2;
    ctx.beginPath(); ctx.moveTo(100,100); ctx.arc(100,100,75,start,start+sw); ctx.closePath();
    ctx.fillStyle=seg.color; ctx.fill(); start+=sw;
  });
  ctx.beginPath(); ctx.arc(100,100,48,0,Math.PI*2); ctx.fillStyle='#ffffff'; ctx.fill();
  const pct=Math.round((completed/total)*100);
  ctx.fillStyle='#0066cc'; ctx.font='bold 22px Bebas Neue'; ctx.textAlign='center'; ctx.fillText(pct+'%',100,106);
  ctx.font='10px DM Mono';
  ctx.fillStyle='#0066cc'; ctx.fillRect(10,188,10,10);
  ctx.fillStyle='#1a2637'; ctx.textAlign='left'; ctx.fillText('Done: '+completed,24,197);
  ctx.fillStyle='#e84c1e'; ctx.fillRect(110,188,10,10);
  ctx.fillStyle='#1a2637'; ctx.fillText('Pending: '+pending,124,197);
}

function renderBar() {
  const c=document.getElementById('barChart'), ctx=c.getContext('2d');
  ctx.clearRect(0,0,c.width,c.height);
  if(!db.entries.length){
    ctx.fillStyle='#6b7e96'; ctx.font='11px DM Mono'; ctx.textAlign='center'; ctx.fillText('No data yet',150,100); return;
  }
  const groups={};
  db.entries.forEach(e=>{
    if(!groups[e.assembly]) groups[e.assembly]={total:0,completed:0};
    groups[e.assembly].total+=e.total; groups[e.assembly].completed+=e.completed;
  });
  const keys=Object.keys(groups).slice(0,5);
  const maxVal=Math.max(...keys.map(k=>groups[k].total),1);
  const barW=Math.floor((c.width-40)/keys.length)-8, chartH=145, baseY=160;
  keys.forEach((key,i)=>{
    const g=groups[key], x=20+i*(barW+8);
    ctx.fillStyle='#d0dbe8';
    ctx.fillRect(x,baseY-(g.total/maxVal)*chartH,barW,(g.total/maxVal)*chartH);
    const dH=(g.completed/maxVal)*chartH;
    const gr=ctx.createLinearGradient(0,baseY-dH,0,baseY);
    gr.addColorStop(0,'#0066cc'); gr.addColorStop(1,'#004499');
    ctx.fillStyle=gr; ctx.fillRect(x,baseY-dH,barW,dH);
    ctx.fillStyle='#6b7e96'; ctx.font='9px DM Mono'; ctx.textAlign='center';
    ctx.fillText(key.length>8?key.substring(0,7)+'‚Ä¶':key,x+barW/2,baseY+14);
    ctx.fillStyle='#0066cc'; ctx.font='10px DM Mono';
    if(dH>0) ctx.fillText(g.completed,x+barW/2,baseY-dH-4);
  });
  ctx.strokeStyle='#d0dbe8'; ctx.lineWidth=1; ctx.beginPath();
  ctx.moveTo(10,baseY); ctx.lineTo(c.width-10,baseY); ctx.stroke();
}

/* ==================== ADMIN ==================== */
function renderAdmin() {
  renderMasterList('models','modelList','modelCount');
  renderMasterList('serials','serialList','serialCount');
  renderMasterList('assemblies','assemblyList','assemblyCount');
  renderUserTable();
}

function renderMasterList(key, listId, countId) {
  const ul=document.getElementById(listId);
  const items=db[key];
  document.getElementById(countId).textContent=items.length+' item'+(items.length!==1?'s':'');
  if(!items.length){ul.innerHTML=`<div class="admin-empty">No items yet. Add one above.</div>`;return;}
  ul.innerHTML=items.map((v,i)=>`
    <li>
      <span>${v}</span>
      <button class="admin-delete-btn" onclick="removeMaster('${key}',${i},'${listId}','${countId}')" title="Remove">‚úï</button>
    </li>`).join('');
}

function addMaster(key, inputId, listId, countId) {
  const inp=document.getElementById(inputId);
  const val=inp.value.trim();
  if(!val){showToast('Enter a value first.','error');return;}
  if(db[key].includes(val)){showToast('Already exists!','error');return;}
  db[key].push(val); save(key); inp.value='';
  renderMasterList(key,listId,countId);
  renderDropdowns();
  showToast(`"${val}" added!`);
}

function removeMaster(key, idx, listId, countId) {
  const val=db[key][idx];
  if(!confirm(`Remove "${val}" from the list?`)) return;
  db[key].splice(idx,1); save(key);
  renderMasterList(key,listId,countId);
  renderDropdowns();
  showToast(`"${val}" removed.`);
}

/* ==================== USER MANAGEMENT ==================== */
function addUser() {
  const u=document.getElementById('newUserName').value.trim();
  const p=document.getElementById('newUserPass').value;
  const r=document.getElementById('newUserRole').value;
  if(!u||!p){showToast('Username and password required.','error');return;}
  if(db.users.find(x=>x.username===u)){showToast('Username already exists!','error');return;}
  db.users.push({id:Date.now(),username:u,password:p,role:r,added:new Date().toLocaleDateString()});
  save('users');
  document.getElementById('newUserName').value='';
  document.getElementById('newUserPass').value='';
  renderUserTable();
  showToast(`User "${u}" added!`);
}

function removeUser(id) {
  const user=db.users.find(u=>u.id===id);
  if(!user) return;
  if(user.username==='admin'){showToast('Cannot delete default admin!','error');return;}
  if(!confirm(`Delete user "${user.username}"?`)) return;
  db.users=db.users.filter(u=>u.id!==id); save('users');
  renderUserTable();
  showToast('User removed.');
}

function renderUserTable() {
  const tbody=document.getElementById('userTableBody');
  tbody.innerHTML=db.users.map((u,i)=>{
    const rc=u.role==='admin'?'var(--accent)':'var(--accent3)';
    const canDel=u.username!=='admin';
    return `<tr>
      <td class="mono" style="color:var(--muted)">${String(i+1).padStart(2,'0')}</td>
      <td><strong>${u.username}</strong></td>
      <td><span style="color:${rc};font-family:'DM Mono',monospace;font-size:0.73rem;text-transform:uppercase;letter-spacing:1px;">${u.role}</span></td>
      <td class="mono" style="color:var(--muted);font-size:0.73rem;">${u.added}</td>
      <td>${canDel?`<button class="action-btn" onclick="removeUser(${u.id})">‚úï DEL</button>`:'<span style="color:var(--muted);font-size:0.7rem">Protected</span>'}</td>
    </tr>`;
  }).join('');
}

/* ==================== UTILS ==================== */
function showToast(msg, type='') {
  const t=document.getElementById('toast');
  t.textContent=msg;
  t.className='toast'+(type?' '+type:'');
  t.classList.add('show');
  setTimeout(()=>t.classList.remove('show'),3000);
}

function updateClock() {
  document.getElementById('clockDisplay').textContent =
    new Date().toLocaleTimeString([],{hour:'2-digit',minute:'2-digit',second:'2-digit'});
}
updateClock();
setInterval(updateClock,1000);
</script>
</body>
</html>
